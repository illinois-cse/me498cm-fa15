<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<title>Notes on Turbulence Modeling</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="../css/style.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration -->

</head>
<body>
<div class="container" id="notebook-container">

<p><a href="http://cse.illinois.edu/"><img src="https://bytebucket.org/davis68/resources/raw/f7c98d2b95e961fae257707e22a58fa1a2c36bec/logos/baseline_cse_wdmk.png?token=be4cc41d4b2afe594f5b1570a3c5aad96a65f0d6" width="100%"/></a></p>
<h2 id="workflow">Notes on Turbulence Modeling</h2>
<h2 id="contents">Contents</h2>

<table><tr><td>
<hr />
<h2 id="Boundary-Layers-and-Flow-Regimes">Boundary Layers and Flow Regimes<a class="anchor-link" href="#Boundary-Layers-and-Flow-Regimes">&#182;</a></h2>
<p>Fluid flow fields illustrate several types of behavior based on the Reynolds number and the proximity to disturbances such as surfaces or solid objects.  These are typically accounted for by boundary layer theory, which posits that many or most quantifiable effects of fluids are due to the viscous layer adjoining the interface.  Indeed, many properties of fluid flows are notably different in the boundary layer from their characteristics in the bulk flow.</p>
<p>Many of the simulation we have conducted up to this point have been <em>laminar</em>—that is, the streamlines tend to run in parallel layers next to the surfaces and cross currents, eddies, and mixing do not occur.</p>
<p>In contrast, turbulent flow is chaotic and exhibits nonzero velocities in all directions, nonzero shear stresses, and time-varying behavior.  Turbulence is characterized by a cascade of large eddies breaking into smaller and smaller eddies at a variety of length scales.  (Thus kinetic energy is transported from the larger length scales to the shorter length scales until it dissipates near the molecular level.)<sup><a href="#Nepf2008">[Nepf2008]</a></sup></p>
<p><img src="./img/lab10/types-of-flow.png" alt=""></p>
<h2 id="The-Navier&#8211;Stokes-Equations-and-Direct-Numerical-Simulation">The Navier&#8211;Stokes Equations and Direct Numerical Simulation<a class="anchor-link" href="#The-Navier&#8211;Stokes-Equations-and-Direct-Numerical-Simulation">&#182;</a></h2><p>As you have seen in your fluid mechanics coursework, a full description of any fluid flow is given by the full Navier–Stokes equations.  The NS equations describe a continuous fluid whose fields are all differentiable at all points; in other words, they describe the conservation of momentum in a fluid flow field.  The equations together account for viscosity, anisotropic effects, and compressibility; their solution is a vector field describing the fluid velocity at any given point.  The most general statement of the Navier–Stokes equations for a compressible fluid<sup><a href="#Foias2001">[Foias2001]</a>, <a href="https://en.wikipedia.org/wiki/Derivation_of_the_Navier%E2%80%93Stokes_equations">[derivation]</a></sup> is</p>
$$\rho \left(\frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \nabla \mathbf{u} \right) = -\nabla \bar{p} + \mu \nabla^2 \mathbf u + \tfrac13 \, \mu \nabla (\nabla\cdot\mathbf{u}) + \rho \mathbf{g} .$$<p>for fluid velocity $\mathbf{u}(\mathbf{x}, t)$, density $\rho$, dynamic viscosity $\mu$ (constant), thermodynamic pressure $\bar{p} \equiv p - \zeta \nabla \cdot \mathbf{u}$, and acceleration due to gravity $\mathbf{g}$.</p>
<p>The solution of the multidimensional nonlinear partial differential equation (and the associated conservation equations for mass and energy, equations of state, etc.) is nontrivial, to say the least.  Many approximations in routine usage are employed to simplify the equations by excluding irrelevant physics (such as anisotropicity or non-Newtonian flow) or by averaging certain properties over the entire flow.  Some types of basic flows even have all nonlinear components equal to zero, permitting analytical solution<sup><a href="#Wang1991">[Wang1991]</a></sup>.</p>
<p>If one has the computational power available to resolve an extremely fine mesh and time step size, then <em>d</em>irect <em>n</em>umerical <em>s</em>imulation (DNS) becomes possible.  In this case, the full Navier–Stokes equations are solved numerically over the grid (for very short time scales).</p>
</td></tr></table>

<table><tr><td>
<hr />
<h2 id="Turbulence-Models">Turbulence Models<a class="anchor-link" href="#Turbulence-Models">&#182;</a></h2><h3 id="Overview">Overview<a class="anchor-link" href="#Overview">&#182;</a></h3><p>A variety of strategies have been developed for dealing with turbulent flows, including the use of <em>mean</em> flow variables $\bar{u}$ coupled with <em>fluctuating</em> variables $u'$.  Another approach is to include an effective <em>eddy viscosity</em> $\varepsilon$ to model the friction losses of the flow due to the turbulent eddies.  Similarly, a friction factor can be included as a semi-empirical effect (if specific velocity flow profiles, shear stresses, and other specific properties of the flow are not required).  (Friction factors are what I learnt to use in my introduction to fluid dynamics course years ago.)<sup><a href="#Nepf2008">[Nepf2008]</a></sup></p>
<p>Further complicating flow physics, two distinct model regimes are required in space:  the boundary layer near the wall is dominated by viscous effects and laminar shear, whereas away from the wall, turbulent shear dominates the flow.  Thus a model which applies well in one domain often fails in the other, requiring an overlapping treatment.</p>
<p>One strategy for dealing with boundary-layer physics (which we'll see more of below) is to employ <em>wall functions</em><sup><a href="#Segal1996">[Segal1996]</a></sup>:  analytical velocity profile laws which compensate for the inability of bulk-flow turbulence equations to accurately reproduce empirical results.</p>
<p>In practice, turbulence modeling typically involves adding one or more additional degrees of freedom, such as turbulent kinetic energy $k$, and corresponding governing equation(s) to the system.  This addition allows the system to relax into a solution (hopefully) closer to experimental observations under chaotic conditions.</p>
<p>There are several ways to classify turbulence models:  by the number of additional equations they add to the system, by the effects over which they average, etc.  We here distinguish three classes:  Reynolds-averaged simulations, large eddy/detached eddy simulations, and direct numerical simulation (which is theoretically but not practically possible in Fluent<sup><a href="http://www.cfd-online.com/Forums/fluent/33103-dns-fluent.html">[bbs]</a></sup>).</p>
<h3 id="Reynolds-Time-Averaged-Navier&#8211;Stokes-(RANS)-Equations[CFD-Wiki]"><em>R</em>eynolds Time-<em>A</em>veraged <em>N</em>avier&#8211;<em>S</em>tokes (RANS) Equations<sup><a href="http://www.cfd-online.com/Wiki/RANS-based_turbulence_models">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Reynolds-Time-Averaged-Navier&#8211;Stokes-(RANS)-Equations[CFD-Wiki]">&#182;</a></h3><p>Reynolds time-averaged turbulence models are steady-state models designed to yield transport quantities across all scales of turbulence.  RANS implements <em>mean</em> flow variables $\bar{u}$ and <em>fluctuating</em> variables $u'$ in order to capture large- and small-scale characteristics of the flow.</p>
<p>The use of time-averaged mean flow variables necessarily implies that RANS solutions are steady-state.  If transient solutions are needed, one can use URANS (<em>u</em>nsteady RANS) to obtain averaged "ensemble" solutions (<em>i.e.</em>, they are not pointwise correct but represent a sort of average solution in time).<sup><a href="http://www.cfd-online.com/Forums/main/135066-transient-rans-simulation.html">[bbs]</a></sup></p>
<h4 id="Linear-Eddy-Viscosity-Modeling">Linear Eddy Viscosity Modeling<a class="anchor-link" href="#Linear-Eddy-Viscosity-Modeling">&#182;</a></h4><h5 id="One-Equation-Models">One-Equation Models<a class="anchor-link" href="#One-Equation-Models">&#182;</a></h5><p>One-equation models compensate by adding a single term such as a pseudoviscosity as a supplementary equation.</p>
<h6 id="Spalart&#8211;Allmaras[CFD-Wiki],-[NASA]">Spalart&#8211;Allmaras<sup><a href="http://www.cfd-online.com/Wiki/Spalart-Allmaras_model">[CFD-Wiki]</a>, <a href="http://turbmodels.larc.nasa.gov/spalart.html">[NASA]</a></sup><a class="anchor-link" href="#Spalart&#8211;Allmaras[CFD-Wiki],-[NASA]">&#182;</a></h6><p>The Spalart–Allmaras model introduces a pseudoviscosity $\tilde{v}$ into the system to account for the friction losses of the turbulent eddies.  No wall functions are required and small near-wall gradients are produced by this model.  In addition, the Spalart–Allmaras model has low memory requirements, is computationally stable and tends to converge rapidly, and is less sensitive to numerical error from a non-layered mesh near the wall.  However, it is inaccurate for shear flow, separated flow, or decaying turbulence.</p>
<h5 id="Two-Equation-Models">Two-Equation Models<a class="anchor-link" href="#Two-Equation-Models">&#182;</a></h5><p>Two-equation models typically include the turbulent kinetic energy $k$.  They are better at accounting for history effects in the flow field, such as the convection and diffusion of turbulent energy.  They tend to strike a good balance between computational efficiency and accuracy.  However, no current two-equation approach can handle buffer layer flow well, in which both Reynolds and viscous stresses are prominent; thus, wall functions are often invoked.</p>
<h6 id="$k$-$\epsilon$[CFD-Wiki]">$k$-$\epsilon$<sup><a href="http://www.cfd-online.com/Wiki/K-epsilon_models">[CFD-Wiki]</a></sup><a class="anchor-link" href="#$k$-$\epsilon$[CFD-Wiki]">&#182;</a></h6><p>The $k$-$\epsilon$ model is a classic and often-used turbulence model.  It is called $k$-$\epsilon$ because it introduces the variables turbulent kinetic energy $k$ and the rate of dissipation of kinetic energy $\epsilon$.  $k$-$\epsilon$ works best for free-shear layer flows with small pressure gradients, and requires wall functions because the buffer region flow is not simulated.  $k$-$\epsilon$ has low memory requirements and demonstrates good convergence properties.  However, it is inaccurate for adverse pressure gradients, strong curvature, and jet flow.</p>
<p>$k$-$\epsilon$ is valid only for fully turbulent flow and should not be used when laminar flow is present in part of the system.</p>
<h6 id="Renormalization-Group-$k$-$\epsilon$[CFD-Wiki]"><em>R</em>e<em>n</em>ormalization <em>G</em>roup $k$-$\epsilon$<sup><a href="http://www.cfd-online.com/Wiki/RNG_k-epsilon_model">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Renormalization-Group-$k$-$\epsilon$[CFD-Wiki]">&#182;</a></h6><p>RNG $k$-$\epsilon$ reformulates the $k$-$\epsilon$ equations with attention to the varying length scale of the relevant turbulent flow.  This makes it generally more accurate and reliable than $k$-$\epsilon$, for rotating flows (including time-dependent turbulent vortex shedding) and especially rotating cavities, as well as favorable for indoor air simulations.  RNG $k$-$\epsilon$ is inaccurate for vortex evolution and unstable in steady-state solutions, and generally requires 10–15% more CPU time than $k$-$\epsilon$.</p>
<h6 id="Realizable-$k$-$\epsilon$[CFD-Wiki],-[Wikipedia]">Realizable $k$-$\epsilon$<sup><a href="http://www.cfd-online.com/Wiki/Realisable_k-epsilon_model">[CFD-Wiki]</a>, <a href="https://en.wikipedia.org/wiki/Realizable_k-_%CE%B5_Model">[Wikipedia]</a></sup><a class="anchor-link" href="#Realizable-$k$-$\epsilon$[CFD-Wiki],-[Wikipedia]">&#182;</a></h6><p>Realizable $k$-$\epsilon$ reformulates the turbulent kinetic energy equations with an eye to satisfying certain mathematical constraints better.  It performs better for rotation, strong adverse pressure gradients, recirculation, mixing, channel and boundary layer flows.  In particular, it predicts spreading rate around planar and round jets, which other turbulence models typically struggle to capture.  However, it tends to produce a nonphysical turbulent viscosity in situations with both rotating and stationary fluid zones (that is, systems with multiple reference frames).</p>
<h6 id="$k$-$\omega$[CFD-Wiki],-[NASA]">$k$-$\omega$<sup><a href="http://www.cfd-online.com/Wiki/Wilcox%27s_k-omega_model">[CFD-Wiki]</a>, <a href="http://turbmodels.larc.nasa.gov/wilcox.html">[NASA]</a></sup><a class="anchor-link" href="#$k$-$\omega$[CFD-Wiki],-[NASA]">&#182;</a></h6><p>The $k$-$\omega$ models, like the $k$-$\epsilon$ models, incorporate two equations.  $k$ is the turbulent kinetic energy and $\omega$ is the specific dissipation rate.  There are no wall functions and low memory requirements; additionally, $k$-$\omega$ is often accurate where $k$-$\epsilon$ fails.  However, $k$-$\omega$ is inaccurate for adverse pressure gradients, strong curvature, and jet flow as well as being oversensitive to inlet free-stream turbulence and being sensitive to the initial guess.</p>
<h6 id="Shear-Stress-Transport-$k$-$\omega$[CFD-Wiki]"><em>S</em>hear <em>S</em>tress <em>T</em>ransport $k$-$\omega$<sup><a href="http://www.cfd-online.com/Wiki/SST_k-omega_model">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Shear-Stress-Transport-$k$-$\omega$[CFD-Wiki]">&#182;</a></h6><p>SST $k$-$\omega$ uses a $k$-$\omega$ formulation near the wall in the boundary layer but switches to a SST $k$-$\epsilon$-like behavior in the free-stream flow.  (This diminishes the oversensitivity to the inlet free-stream turbulence.)  SST $k$-$\omega$ tends to be accurate near the wall but overestimates turbulence in regions with large normal strain.  It is often cited for behaving well in regions with separating flow.  SST $k$-$\omega$ also tends to converge slowly, so it is often convenient to use another model for the initial guess.</p>
<h4 id="Reynolds-Stress-Transport-Model-(RSM)[CFD-Wiki]"><em>R</em>eynolds <em>S</em>tress Transport <em>M</em>odel (RSM)<sup><a href="http://www.cfd-online.com/Wiki/Reynolds_stress_model_%28RSM%29">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Reynolds-Stress-Transport-Model-(RSM)[CFD-Wiki]">&#182;</a></h4><p>The Reynolds stress transport model introduces the turbulent kinetic energy $k$ and the rate of dissipation of kinetic energy $\omega$.  RSM is particularly suited for describing anisotropic turbulence, such as highly swirling flows and stress-driven secondary flows.  It is moderately computationally expensive (expect to use 50–60% more CPU time and 15–20% more memory over $k$–$\epsilon$ modeling), and it tends to converge slowly.</p>
<h3 id="Detached-Eddy-Simulation-(DES)[CFD-Wiki]"><em>D</em>etached <em>E</em>ddy <em>S</em>imulation (DES)<sup><a href="http://www.cfd-online.com/Wiki/Detached_eddy_simulation_%28DES%29">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Detached-Eddy-Simulation-(DES)[CFD-Wiki]">&#182;</a></h3><p>Detached eddy simulations are a hybrid treatment using a RANS approach (typically Spalart–Allmaras) near the wall and an LES approach in the bulk flow.  However, a complicated grid generation procedure is required for this method to be effective.</p>
<h3 id="Large-Eddy-Simulation-(LES)[CFD-Wiki]"><em>L</em>arge <em>E</em>ddy <em>S</em>imulation (LES)<sup><a href="http://www.cfd-online.com/Wiki/Large_eddy_simulation_%28LES%29">[CFD-Wiki]</a></sup><a class="anchor-link" href="#Large-Eddy-Simulation-(LES)[CFD-Wiki]">&#182;</a></h3><p>Large eddy simulations have become popular as a compromise between DNS and the computational efficiency of the RANS models.  LES introduces the Smagorinsky constant $C_S$ to help resolve large scales in the flow field while modeling small scales instead of directly solving them.  (This gives it its speed edge over DNS.)  However, there are challenges in determining $C_S$ and the method is still quite computationally expensive compared to simpler turbulence models.</p>
<h3 id="Direct-Numerical-Simulation-(DNS)"><em>D</em>irect <em>N</em>umerical <em>S</em>imulation (DNS)<a class="anchor-link" href="#Direct-Numerical-Simulation-(DNS)">&#182;</a></h3><p>In principle, Fluent <em>could</em> effect a direct numerical solution of the full Navier–Stokes equations by using a time-varying laminar flow model with an incredibly fine grid ($\lesssim 10 \,\mu\text{m}$) and a very short time step ($10^{-10} \,\text{s}$).  Of course, you'd never do this in practice since the computational and memory requirements are absolutely prohibitive.</p>
<p>(As a trivial aside, the Navier–Stokes equations have <em>not</em> been <em>proven</em> to properly handle turbulence<sup><a href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations#Turbulence">[Wikipedia]</a></sup>, although this conjecture is widely accepted and supported by practical experience.  This says more about our understanding of turbulence than it does about the Navier–Stokes equations.)</p>
</td></tr></table>

<hr />
<h2 id="credits">Credits</h2>
<p>Neal Davis developed these materials for <a href="http://cse.illinois.edu/">Computational Science and Engineering</a> at the University of Illinois at Urbana–Champaign.</p>
<p><img src="http://i.creativecommons.org/l/by-nc/4.0/88x31.png" align="left"> This content is available under a <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 Unported License</a>.</p>
<p><a href="http://cse.illinois.edu/"><img src="https://bytebucket.org/davis68/resources/raw/f7c98d2b95e961fae257707e22a58fa1a2c36bec/logos/baseline_cse_wdmk.png?token=be4cc41d4b2afe594f5b1570a3c5aad96a65f0d6" width="100%"/></a></p>
</body>
</html>